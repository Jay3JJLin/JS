<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>闭包</title>
</head>

<body>
    <script>
        // 里层函数 + 外层函数的变量 = 闭包

        // 简单写法
        // function outer() {
        //     let a = 10;
        //     function fn() {
        //         console.log(a);
        //     }
        //     fn();
        // }
        // outer();

        // 常见闭包形式 外部可以访问使用 函数内部的变量
        // function outer() {
        //     let a = 10;
        //     function fn() {
        //         console.log(a);
        //     }
        //     return fn;//返回函数
        // }
        // // outer() === fn === function fn() { }
        // // const fun = function fn() { }
        // const fun = outer();//相当于接过来的是函数
        // // 调用函数
        // fun();

        // 外面要使用这个 a

        // 闭包应用：
        // 普通形式 统计函数调用的次数
        // let i = 0;
        // function fn() {
        //     i++;
        //     console.log(`函数被调用了${i}次`);
        // }

        // 因为 i 是全局变量，容易被修改
        // 闭包形式 统计函数调用的次数 实现数据私有
        function count() {
            let i = 0;
            function fn() {
                i++;
                console.log(`函数被调用了${i}次`);
            }
            return fn;
        }
        const fun = count();//全局作用域，会一直使用fn
        fun();//相当于调用fn  即fn()
        //count()先调用函数count,返回一个函数fn,所以在count()的基础上再加(),也就是fun加()即fun(),就是调用函数fn
        // 以至于不会反复触发let i = 0
    </script>
</body>

</html>

<!-- 
概念：一个函数对周围状态的引用捆绑在一起，内层函数中访问到其外层函数的作用域
简单理解：闭包 =  内层函数 + 外层函数的变量
闭包作用：封闭数据，提供操作，外部也可以访问函数内部的变量

闭包应用：实现数据的私有
比如，我们要做个统计函数调用次数，函数调用一次，就++


1. 怎么理解闭包？
Ø 闭包 = 内层函数 + 外层函数的变量
2. 闭包的作用？
Ø 封闭数据，实现数据私有，外部也可以访问函数内部的变量
Ø 闭包很有用，因为它允许将函数与其所操作的某些数据（环境）关联起来
3. 闭包可能引起的问题？
Ø 内存泄漏
 -->